import numpy as np
from colour.models import Lab_to_XYZ

def XYZ_to_lms(XYZ_values):
    values = np.array([[0.81893, 0.36187, -0.12886],
                       [0.03298, 0.92931, 0.03615],
                       [0.04820, 0.26437, 0.63385]])
    

    result = np.dot(values, XYZ_values.T).T
    return result

def lms_to_OkLab(lms_values):
    values = np.array([[0.21045, 0.79362, -0.00407],
                       [1.97800, -2.42860, 0.45060],
                       [0.02590, 0.78277, -0.80868]])
    result = np.dot(values, lms_values.T).T
    return result

# 定义 Lab 色值
lab_values = np.array([
    [27.7, -1.3, -1.6],
    [37.6, -1.8, -2.1],
    [33.4, -3.7, -4.2],
    [28.2, -3.1, -1.3],
    [26.7, 1.8, -1.7],
    [25.1, 9.4, 1.7],
    [36.6, -1.3, 3],
    [41.5, -2.4, 6.4],
    [32.5, 0.5, 1.1],
    [30.5, -2.9, -5.2],
    [32.5, 0.8, -2],
    [27.1, -1.3, -3.9],
    [28.9, -4.9, -0.7],
    [30, -12.1, 5.7],
    [26.9, -6.7, -4.3],
    [41.3, -11.4, -3.8],
    [35.7, -2.9, -4.4],
    [37.1, -5.8, -3.2],
    [34.6, -4, 1],
    [35.2, -0.3, 1.4],
    [25.9, -2.8, -5.2],
    [25.1, -2.9, -12.3],
    [33.8, 0.5, -4],
    [37.4, 5.4, -7.8],
    [49.6, -3.4, -1.3],
    [47.1, -3.3, -1.8],
    [42.5, -3.3, -2.9],
    [37.9, -3.2, -2.9],
    [32.5, -2.8, -2.8],
    [27.4, -2.4, -2.5],
    [21.8, -2.1, -2.2],
    [13, -1, -1.8]
])

XYZ_values = Lab_to_XYZ(lab_values)

lms_values = XYZ_to_lms(XYZ_values) / 3.0

OkLab_values = lms_to_OkLab(lms_values)

print(lms_values)

